<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 3 The linear model | Statistical tests as linear models</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 3 The linear model | Statistical tests as linear models" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 The linear model | Statistical tests as linear models" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Steve Doogue">


<meta name="date" content="2019-04-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="the-data.html">
<link rel="next" href="correlations.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="the-data.html"><a href="the-data.html"><i class="fa fa-check"></i><b>2</b> The data</a><ul>
<li class="chapter" data-level="2.1" data-path="the-data.html"><a href="the-data.html#sample-values"><i class="fa fa-check"></i><b>2.1</b> Sample values</a></li>
<li class="chapter" data-level="2.2" data-path="the-data.html"><a href="the-data.html#rank_trans"><i class="fa fa-check"></i><b>2.2</b> Rank-transformed values</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>3</b> The linear model</a><ul>
<li class="chapter" data-level="3.1" data-path="the-linear-model.html"><a href="the-linear-model.html#overview-of-the-linear-model"><i class="fa fa-check"></i><b>3.1</b> Overview of the linear model</a></li>
<li class="chapter" data-level="3.2" data-path="the-linear-model.html"><a href="the-linear-model.html#estimating-linear-models-in-r"><i class="fa fa-check"></i><b>3.2</b> Estimating linear models in R</a></li>
<li class="chapter" data-level="3.3" data-path="the-linear-model.html"><a href="the-linear-model.html#assumptions"><i class="fa fa-check"></i><b>3.3</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i><b>4</b> Correlations</a><ul>
<li class="chapter" data-level="4.1" data-path="correlations.html"><a href="correlations.html#pearson-correlation"><i class="fa fa-check"></i><b>4.1</b> Pearson correlation</a></li>
<li class="chapter" data-level="4.2" data-path="correlations.html"><a href="correlations.html#spearman-correlation"><i class="fa fa-check"></i><b>4.2</b> Spearman correlation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="appendix-1-types-of-variables.html"><a href="appendix-1-types-of-variables.html"><i class="fa fa-check"></i><b>5</b> Appendix 1 - Types of variables</a><ul>
<li class="chapter" data-level="5.1" data-path="appendix-1-types-of-variables.html"><a href="appendix-1-types-of-variables.html#discrete-variables"><i class="fa fa-check"></i><b>5.1</b> Discrete variables</a></li>
<li class="chapter" data-level="5.2" data-path="appendix-1-types-of-variables.html"><a href="appendix-1-types-of-variables.html#continuous-variables"><i class="fa fa-check"></i><b>5.2</b> Continuous variables</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical tests as linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-linear-model" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> The linear model</h1>
<div id="overview-of-the-linear-model" class="section level2">
<h2><span class="header-section-number">3.1</span> Overview of the linear model</h2>
<p>Many common statistical tests are really just special cases of the linear model, or at least a close approximation.</p>
<p>What is meant by linear model? This section provides an overview of the linear model. The description may be somewhat fast and loose, as it aims to provide an intuitive explanation rather than a rigorous technical description.</p>
<p>The linear model, or linear regression model, estimates the relationship between one variable and one or more other variables. It is assumed that the relationship can be described as a straight line.</p>
<p>For example, assume we are looking at a variable <span class="math inline">\(y\)</span> and we want to know its relationship with a variable <span class="math inline">\(x\)</span>. We assume that the relationship can be expressed as a mathematical relationship between <span class="math inline">\(y\)</span> (the dependent variable) and <span class="math inline">\(x\)</span> (the explanatory variable):</p>
<p><span class="math inline">\(y = \beta_0 + \beta_1 x\)</span></p>
<p>To illustrate what this equation is showing, imagine we have six observations of variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, which can be plotted as follows:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="images/image01.png" alt="Six observations of x and y" width="60%" />
<p class="caption">
Figure 3.1: Six observations of x and y
</p>
</div>
<p>We assume that this relationship can be represented by a straight line. The line is composed of an intercept (<span class="math inline">\(\beta_0\)</span>) and a slope (<span class="math inline">\(\beta_1\)</span>). Each point on this line represents our <em>predicted</em> value of <span class="math inline">\(y\)</span> for a given value of <span class="math inline">\(x\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-8"></span>
<img src="images/image02.png" alt="Intercept and slope of model" width="60%" />
<p class="caption">
Figure 3.2: Intercept and slope of model
</p>
</div>
<p>So how do we estimate the intercept and slope? In other words, how do we estimate what the values of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> should be?</p>
<p>Linear regression estimates the line (i.e., slope and intercept) that minimizes the difference between our <em>predicted</em> values of <span class="math inline">\(y\)</span> and the <em>actual</em> values of <span class="math inline">\(y\)</span> that were observed in the original sample. These difference are referred to as “residuals”.</p>
<p>More specifically, linear regression minimizes the sum of the <em>squared</em> value of these residuals. So in the figure below, linear regression is used to estimate the line that would minimise the combined area of the purple squares. For this reason, the method is sometimes referred to as an “ordinary least squares” (OLS) regression.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-9"></span>
<img src="images/image03.png" alt="Line of best fit minimizes the sum of squared residuals" width="60%" />
<p class="caption">
Figure 3.3: Line of best fit minimizes the sum of squared residuals
</p>
</div>
<p>In the example above, we considered a dependent variable (<span class="math inline">\(y\)</span>) that was being “explained” by one other variable, or predictor (<span class="math inline">\(x\)</span>). But this can be expanded to include multiple predictors, for example with the model:</p>
<p><span class="math inline">\(y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 ... + \beta_i x_i\)</span></p>
<p>This is referred to as <em>multiple regression</em>. In this case we still have only one intercept (<span class="math inline">\(\beta_0\)</span>) but many slopes that need to be estimated (<span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span> and so on). The same method can be used to estimate these parameters, i.e. an OLS regression which minimizes the sum of squared residuals. This cannot be illustrated in a two-dimensional diagram, as was the case when a single predictor was used, but the exact same concept applies.</p>
</div>
<div id="estimating-linear-models-in-r" class="section level2">
<h2><span class="header-section-number">3.2</span> Estimating linear models in R</h2>
<p>To estimate linear models in R we use the <code>lm()</code> function.</p>
<p>For example, say we want to estimate the relationship (if any) between our sampled data for <code>x</code> and <code>y</code>. We will apply the following model: <span class="math inline">\(y = \beta_0 + \beta_1 x\)</span></p>
<p>In R, this can be written as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x)  <span class="co"># Represents y = beta0 + beta1 * x</span></code></pre></div>
<p>In the original book, the specified model is accompanied by the null hypothesis, <span class="math inline">\(H_0: \beta_1=0\)</span>. This is equivalent to saying that there is no relationship between <code>x</code> and <code>y</code>. The output from our linear model tells us whether there could be grounds for rejecting this null hypothesis of “no relationship”, in favor of the alternative hypothesis that there <em>is</em> a relationship.</p>
<p>A key output of interest, or test statistic, is the p-value.</p>
<ul>
<li>A small p-value (conventionally ≤ 0.05) indicates strong evidence against the null hypothesis, so you reject the null hypothesis of no relationship.</li>
<li>A larger p-value (&gt; 0.05) indicates weak evidence against the null hypothesis, so you fail to reject the null hypothesis of no relationship.</li>
</ul>
<p>Lets see the output of the lineary model for our sample data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">digits =</span> <span class="dv">5</span>) </code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -3.93980 -1.09967  0.12548  1.27904  3.88372 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  0.30000    0.27799  1.0792   0.2859
## x           -0.46355    0.28081 -1.6507   0.1053
## 
## Residual standard error: 1.9657 on 48 degrees of freedom
## Multiple R-squared:  0.05372,    Adjusted R-squared:  0.034006 
## F-statistic:  2.725 on 1 and 48 DF,  p-value: 0.10532</code></pre>
<p>As seen in the output above, <span class="math inline">\(\beta_1\)</span> (the coefficient on <code>x</code>) has a p-value of 0.1053. This means we would fail to reject the null hypothesis that there was no relationship between <code>x</code> and <code>y</code>.</p>
</div>
<div id="assumptions" class="section level2">
<h2><span class="header-section-number">3.3</span> Assumptions</h2>
<p>The linear model described above is only valid if a number of assumption hold.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["stat_tests.pdf", "stat_tests.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
